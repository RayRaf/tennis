{% extends 'base.html' %}
{% load static %}
{% block title %}{{ title }}{% endblock %}

{% block extra_css %}
<style>
/* Принудительные стили для горизонтального расположения кнопок в play_game */
.game-player-container {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    justify-content: space-between !important;
    gap: 1rem !important;
    margin: 1.5rem auto !important;
    width: 100% !important;
    max-width: 600px !important;
}

/* Кнопки и их расположение */
.game-player-container button:hover {
    transform: translateY(-2px) scale(1.05) !important;
    transition: all 0.3s ease !important;
}

/* Мобильные стили */
@media (max-width: 768px) {
    .game-player-container {
        max-width: 100% !important;
        margin: 1rem auto !important;
        gap: 0.75rem !important;
    }
    
    .game-player-container button {
        min-width: 3.5rem !important;
        height: 3.5rem !important;
        font-size: 1.25rem !important;
    }
    
    .game-player-container .player {
        font-size: 1rem !important;
        padding: 1rem 0.5rem !important;
        margin: 0 0.5rem !important;
    }
}

/* Очень маленькие экраны */
@media (max-width: 480px) {
    .game-player-container {
        gap: 0.5rem !important;
        margin: 1rem auto !important;
    }
    
    .game-player-container button {
        min-width: 3rem !important;
        height: 3rem !important;
        font-size: 1.1rem !important;
    }
    
    .game-player-container .player {
        font-size: 0.9rem !important;
        padding: 0.75rem 0.25rem !important;
        margin: 0 0.25rem !important;
    }
}
</style>
{% endblock %}

{% block content %}
    <h1>{{ header }}</h1>
    <div class="container">
        {% if not is_tournament %}
        <div id="setup">
            <label>Игрок 1:
                <select id="player1">
                    {% for player in players %}
                        <option value="{{ player.full_name }}">{{ player.full_name }}</option>
                    {% endfor %}
                </select>
            </label>
            <label>Игрок 2:
                <select id="player2">
                    {% for player in players %}
                        <option value="{{ player.full_name }}">{{ player.full_name }}</option>
                    {% endfor %}
                </select>
            </label>
            <button onclick="startGame()">Начать игру</button>
        </div>
        {% endif %}
    <div id="game" {% if is_tournament %}style="display:block;"{% else %}style="display:none;"{% endif %}>
            <div class="game-player-container" style="display: flex !important; flex-direction: row !important; align-items: center !important; justify-content: space-between !important; gap: 1rem; margin: 1.5rem auto; max-width: 600px; width: 100%;">
                <button id="btnRemove1" onclick="removePoint(1)" style="order: 1; min-width: 4rem; height: 4rem; border-radius: 50%; font-size: 1.5rem; font-weight: 700; background: linear-gradient(135deg, #ff6b6b, #ffa500); color: white; border: none; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.2); flex-shrink: 0;">-</button>
                <div id="p1" class="player" style="order: 2; flex: 1; text-align: center; padding: 1.5rem; background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3); border-radius: 16px; font-size: 1.25rem; font-weight: 600; margin: 0 1rem;">
                    <span id="name1">{% if is_tournament %}{{ match.player1.full_name }}{% endif %}</span>: <span class="score" id="score1">{% if is_tournament %}{{ score.0 }}{% else %}0{% endif %}</span>
                </div>
                <button id="btnAdd1" onclick="addPoint(1)" style="order: 3; min-width: 4rem; height: 4rem; border-radius: 50%; font-size: 1.5rem; font-weight: 700; background: linear-gradient(135deg, #43e97b, #38f9d7); color: white; border: none; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.2); flex-shrink: 0;">+</button>
            </div>
            <div class="game-player-container" style="display: flex !important; flex-direction: row !important; align-items: center !important; justify-content: space-between !important; gap: 1rem; margin: 1.5rem auto; max-width: 600px; width: 100%;">
                <button id="btnRemove2" onclick="removePoint(2)" style="order: 1; min-width: 4rem; height: 4rem; border-radius: 50%; font-size: 1.5rem; font-weight: 700; background: linear-gradient(135deg, #ff6b6b, #ffa500); color: white; border: none; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.2); flex-shrink: 0;">-</button>
                <div id="p2" class="player" style="order: 2; flex: 1; text-align: center; padding: 1.5rem; background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3); border-radius: 16px; font-size: 1.25rem; font-weight: 600; margin: 0 1rem;">
                    <span id="name2">{% if is_tournament %}{{ match.player2.full_name }}{% endif %}</span>: <span class="score" id="score2">{% if is_tournament %}{{ score.1 }}{% else %}0{% endif %}</span>
                </div>
                <button id="btnAdd2" onclick="addPoint(2)" style="order: 3; min-width: 4rem; height: 4rem; border-radius: 50%; font-size: 1.5rem; font-weight: 700; background: linear-gradient(135deg, #43e97b, #38f9d7); color: white; border: none; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.2); flex-shrink: 0;">+</button>
            </div>
            <p id="turn"></p>
            <p id="winner">{% if is_tournament and match.finished %}Победитель: {{ match.winner.full_name }}{% endif %}</p>
            {% if not is_tournament %}
            <button onclick="resetGame()">Новая игра</button>
            <button id="finishGameBtn" onclick="finishGame()" style="display: none;">Завершить партию</button>
            <input type="hidden" id="gameStartTime">
            {% else %}
            <form method="post" style="display:inline;">{% csrf_token %}<input type="hidden" name="action" value="p1"/><button type="submit">+1 {{ match.player1.full_name }}</button></form>
            <form method="post" style="display:inline;">{% csrf_token %}<input type="hidden" name="action" value="p2"/><button type="submit">+1 {{ match.player2.full_name }}</button></form>
            <a class="btn" href="{% url 'tennis_app:tournament_detail' match.tournament.id %}">Назад</a>
            {% endif %}
        </div>
    </div>
{% endblock %}
{% block extra_js %}
{% if is_tournament %}
<script src="{% static 'js/play.js' %}"></script>
{% else %}
<script src="{% static 'js/friend_play.js' %}"></script>
{% endif %}
{% endblock %}
